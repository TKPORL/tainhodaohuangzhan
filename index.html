<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8" />
  <title>Tsinho-Nav 单文件版</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover" />
  <style>
    body { font-family: -apple-system, BlinkMacSystemFont, "SF Pro Text", system-ui, sans-serif; margin:0; background:#F2F2F7; }
    .app-header { padding:12px; background:#fff; box-shadow:0 2px 4px rgba(0,0,0,0.1); display:flex; justify-content:space-between; }
    .app-title { font-weight:bold; }
    .section-card { margin:12px; padding:12px; background:#fff; border-radius:12px; box-shadow:0 2px 4px rgba(0,0,0,0.1); }
    .sites-grid { display:grid; grid-template-columns:repeat(auto-fill,minmax(120px,1fr)); gap:8px; }
    .site-item { padding:8px; background:#f9f9f9; border-radius:8px; text-align:center; cursor:pointer; }
    .site-item:hover { background:#eee; }
  </style>
</head>
<body>
  <header class="app-header">
    <div class="app-title">Tsinho-Nav</div>
    <button id="adminButton">管理员</button>
  </header>
  <main id="sectionsContainer"></main>

  <!-- 配置数据直接嵌入 HTML -->
  <script type="application/json" id="configData">
  {
    "libraries": [
      {
        "id": "lib-default",
        "name": "默认资源库",
        "description": "示例：内置一些常用站点，可按需修改或删除。",
        "requirePassword": false,
        "password": "",
        "order": 1
      }
    ],
    "sections": [
      {
        "id": "sec-1",
        "libraryId": "lib-default",
        "name": "常用工具",
        "displayType": "title",
        "visible": true,
        "order": 1
      },
      {
        "id": "sec-2",
        "libraryId": "lib-default",
        "name": "开发 & 社区",
        "displayType": "title",
        "visible": true,
        "order": 2
      }
    ],
    "sites": [
      {
        "id": "site-1",
        "libraryId": "lib-default",
        "sectionId": "sec-1",
        "name": "百度",
        "url": "https://www.baidu.com",
        "icon": "",
        "tags": ["搜索"],
        "visible": true,
        "order": 1
      },
      {
        "id": "site-2",
        "libraryId": "lib-default",
        "sectionId": "sec-2",
        "name": "GitHub",
        "url": "https://github.com",
        "icon": "",
        "tags": ["开发","代码"],
        "visible": true,
        "order": 1
      }
    ]
  }
  </script>

  <script>
    let state = { libraries:[], sections:[], sites:[] };

    function loadData() {
      const raw = document.getElementById("configData").textContent;
      const data = JSON.parse(raw);
      state.libraries = data.libraries || [];
      state.sections = data.sections || [];
      state.sites = data.sites || [];
    }

    function render() {
      const container = document.getElementById("sectionsContainer");
      container.innerHTML = "";
      const sections = state.sections.sort((a,b)=>a.order-b.order);
      for(const sec of sections){
        const card = document.createElement("div");
        card.className="section-card";
        card.innerHTML=`<h3>${sec.name}</h3>`;
        const grid=document.createElement("div");
        grid.className="sites-grid";
        const sites=state.sites.filter(s=>s.sectionId===sec.id).sort((a,b)=>a.order-b.order);
        for(const site of sites){
          const item=document.createElement("div");
          item.className="site-item";
          item.textContent=site.name;
          item.onclick=()=>window.open(site.url,"_blank");
          grid.appendChild(item);
        }
        card.appendChild(grid);
        container.appendChild(card);
      }
    }

    document.addEventListener("DOMContentLoaded",()=>{
      loadData();
      render();
    });
  </script>
</body>
</html>